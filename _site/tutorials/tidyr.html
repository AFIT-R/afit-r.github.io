<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>R Programming @ UC</title>
    <meta name="description" content="">

    <link rel="stylesheet" href="http://r-uc.github.io//css/main.css">
    <link rel="canonical" href="http://r-uc.github.io/http://r-uc.github.io//tutorials/tidyr">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="http://r-uc.github.io/">R Programming @ UC</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="http://r-uc.github.io//404">404 - Page not found</a>
          
        
          
          <a class="page-link" href="http://r-uc.github.io//about/">About</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://r-uc.github.io//categoryview/">Archive</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://r-uc.github.io//cv/">CV</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://r-uc.github.io//tutorials/">Tutorials</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://r-uc.github.io//tutorials/scraping_with_apis_DSCOE.Rmd">Scraping Data with APIs</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <article class="post-content">
    <p><a href="index">R Vocab Topics</a> » <a href="data_wrangling">Data wrangling</a> » tidyr for reshaping the layout of data frames</p>

<p><br /></p>

<p>Although many fundamental data processing functions exist in R, they have been a bit convoluted to date and have lacked consistent coding 
and the ability to easily <em>flow</em> together.  This leads to difficult-to-read nested functions and/or <em>choppy</em> code. <a href="http://www.rstudio.com/">R Studio</a> is driving a lot of new packages to collate data management tasks and better integrate them with other analysis activities.
As a result, a lot of data processing tasks are becoming packaged in more cohesive and consistent ways, which leads to:</p>

<ul>
  <li>More efficient code</li>
  <li>Easier to remember syntax</li>
  <li>Easier to read syntax</li>
</ul>

<p><code class="highlighter-rouge">tidyr</code> is a one such package which was built for the sole purpose of simplifying the process of creating <a href="http://vita.had.co.nz/papers/tidy-data.html">tidy data</a>. This tutorial provides you with the basic understanding of the four fundamental functions of data tidying that tidyr provides:</p>

<ul>
  <li><a href="#gather"><strong><code class="highlighter-rouge">gather()</code></strong></a> makes “wide” data longer</li>
  <li><a href="#spread"><strong><code class="highlighter-rouge">spread()</code></strong></a> makes “long” data wider</li>
  <li><a href="#separate"><strong><code class="highlighter-rouge">separate()</code></strong></a> splits a single column into multiple columns</li>
  <li><a href="#unite"><strong><code class="highlighter-rouge">unite()</code></strong></a> combines multiple columns into a single column</li>
  <li><a href="#resources">Additional Resources</a></li>
</ul>

<p><br /></p>

<h2 id="upackages-utilizedu"><u>Packages Utilized</u></h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">install.packages</span><span class="p">(</span><span class="s2">"tidyr"</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span></code></pre></figure>

<p><br /></p>

<p><a id="pipe"> </a></p>

<h2 id="ufont-faceconsolasfont-operatoru"><u><font face="consolas">%&gt;%</font> Operator</u></h2>

<p>Although not required, the tidyr and dplyr packages make use of the pipe operator <code class="highlighter-rouge">%&gt;%</code> developed by <a href="https://twitter.com/stefanbache">Stefan Milton Bache</a> in the R package <a href="http://cran.r-project.org/web/packages/magrittr/magrittr.pdf">magrittr</a>.  Although all the functions in tidyr and dplyr <em>can be used without the pipe operator</em>, one of the great conveniences these packages provide is the ability to string multiple functions together by incorporating <code class="highlighter-rouge">%&gt;%</code>.</p>

<p>This operator will forward a value, or the result of an expression, into the next function call/expression.  For instance a function to filter data can be written as:</p>

<center>filter(data, variable == <em>numeric_value</em>)</center>

<center><em><u>or</u></em></center>

<center>data %&gt;% filter(variable == <em>numeric_value</em>)</center>

<p><br /></p>

<p>Both functions complete the same task and the benefit of using <code class="highlighter-rouge">%&gt;%</code> is not evident; however, when you desire to perform multiple functions its advantage becomes obvious.  For instance, if we want to filter some data, summarize it, and then order the summarized results we would write it out as:</p>

<p>  <u>Nested Option:</u></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">arrange</span><span class="p">(</span>
    <span class="n">summarize</span><span class="p">(</span>
        <span class="n">filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">variable</span> <span class="o">==</span> <span class="o">*</span><span class="n">numeric_value</span><span class="o">*</span><span class="p">),</span>
        <span class="n">Total</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">desc</span><span class="p">(</span><span class="n">Total</span><span class="p">)</span><span class="o">&lt;</span><span class="n">br</span><span class="o">&gt;</span>
<span class="p">)</span></code></pre></figure>

<p>            <em><u>or</u></em></p>

<p>  <u>Multiple Object Option:</u></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">a</span> <span class="o">&lt;-</span> <span class="n">filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">variable</span> <span class="o">==</span> <span class="o">*</span><span class="n">numeric_value</span><span class="o">*</span><span class="p">)</span>
<span class="n">b</span> <span class="o">&lt;-</span> <span class="n">summarise</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Total</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span><span class="n">variable</span><span class="p">))</span>
<span class="n">c</span> <span class="o">&lt;-</span> <span class="n">arrange</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">desc</span><span class="p">(</span><span class="n">Total</span><span class="p">))</span></code></pre></figure>

<p>            <em><u>or</u></em></p>

<p>  <u>%&gt;% Option:</u></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">data</span> <span class="o">%&gt;%</span>
    <span class="n">filter</span><span class="p">(</span><span class="n">variable</span> <span class="o">==</span> <span class="s2">"value"</span><span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="n">summarise</span><span class="p">(</span><span class="n">Total</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span><span class="n">variable</span><span class="p">))</span> <span class="o">%&gt;%</span>
    <span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">Total</span><span class="p">))</span></code></pre></figure>

<p>As your function tasks get longer the <code class="highlighter-rouge">%&gt;%</code> operator becomes more efficient <em><u>and</u></em> makes your code more legible.  In addition, although not covered in this tutorial, the <code class="highlighter-rouge">%&gt;%</code> operator allows you to flow from data manipulation tasks straight into vizualization functions <em>(via ggplot and ggvis)</em> and also into many analytic functions.</p>

<p>To learn more about the <code class="highlighter-rouge">%&gt;%</code> operator and the magrittr package visit any of the following:</p>

<ul>
  <li><a href="http://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html">http://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html</a></li>
  <li><a href="http://www.r-bloggers.com/simpler-r-coding-with-pipes-the-present-and-future-of-the-magrittr-package/">http://www.r-bloggers.com/simpler-r-coding-with-pipes-the-present-and-future-of-the-magrittr-package/</a></li>
  <li><a href="http://blog.revolutionanalytics.com/2014/07/magrittr-simplifying-r-code-with-pipes.html">http://blog.revolutionanalytics.com/2014/07/magrittr-simplifying-r-code-with-pipes.html</a></li>
</ul>

<p><a href="#">Go to top</a></p>

<p><br /></p>

<p><a id="gather"> </a></p>

<h2 id="ugather--functionu"><u>gather( ) function</u>:</h2>
<p><strong>Objective:</strong> Reshaping wide format to long format</p>

<p><strong>Description:</strong> There are times when our data is considered unstacked and a common attribute of concern is spread out across columns.  To reformat the data such that these common attributes are <em>gathered</em> together as a single variable, the <code class="highlighter-rouge">gather()</code> function will take multiple columns and collapse them into key-value pairs, duplicating all other columns as needed.</p>

<p><img src="/public/images/dataWrangling/gather1.png" alt="gather() function" align="middle" vspace="25" /></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">Function</span><span class="o">:</span>       <span class="n">gather</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="k">...</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">,</span> <span class="n">convert</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span>
<span class="n">Same</span> <span class="n">as</span><span class="o">:</span>        <span class="n">data</span> <span class="o">%&gt;%</span> <span class="n">gather</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="k">...</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">,</span> <span class="n">convert</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
        <span class="n">data</span><span class="o">:</span>           <span class="n">data</span> <span class="n">frame</span>
        <span class="n">key</span><span class="o">:</span>            <span class="n">column</span> <span class="n">name</span> <span class="n">representing</span> <span class="n">new</span> <span class="n">variable</span>
        <span class="n">value</span><span class="o">:</span>          <span class="n">column</span> <span class="n">name</span> <span class="n">representing</span> <span class="n">variable</span> <span class="n">values</span>
        <span class="k">...</span><span class="o">:</span>            <span class="n">names</span> <span class="n">of</span> <span class="n">columns</span> <span class="n">to</span> <span class="n">gather</span> <span class="p">(</span><span class="n">or</span> <span class="n">not</span> <span class="n">gather</span><span class="p">)</span>
        <span class="n">na.rm</span><span class="o">:</span>          <span class="n">option</span> <span class="n">to</span> <span class="n">remove</span> <span class="n">observations</span> <span class="n">with</span> <span class="n">missing</span> <span class="n">values</span> <span class="p">(</span><span class="n">represented</span> <span class="n">by</span> <span class="n">NAs</span><span class="p">)</span>
        <span class="n">convert</span><span class="o">:</span>        <span class="k">if</span> <span class="n">TRUE</span> <span class="n">will</span> <span class="n">automatically</span> <span class="n">convert</span> <span class="n">values</span> <span class="n">to</span> <span class="n">logical</span><span class="p">,</span> <span class="n">integer</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">complex</span> <span class="n">or</span> <span class="n">factor</span> <span class="n">as</span> <span class="n">appropriate</span></code></pre></figure>

<p>☛ <em>This function is a complement to <a href="#spread"><code class="highlighter-rouge">spread()</code></a></em></p>

<p><strong>Example</strong></p>

<p>We’ll start with the following data set:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">## Source: local data frame [12 x 6]
## 
##    Group Year Qtr.1 Qtr.2 Qtr.3 Qtr.4
## 1      1 2006    15    16    19    17
## 2      1 2007    12    13    27    23
## 3      1 2008    22    22    24    20
## 4      1 2009    10    14    20    16
## 5      2 2006    12    13    25    18
## 6      2 2007    16    14    21    19
## 7      2 2008    13    11    29    15
## 8      2 2009    23    20    26    20
## 9      3 2006    11    12    22    16
## 10     3 2007    13    11    27    21
## 11     3 2008    17    12    23    19
</span><span class="err">##</span> <span class="m">12</span>     <span class="m">3</span> <span class="m">2009</span>    <span class="m">14</span>     <span class="m">9</span>    <span class="m">31</span>    <span class="m">24</span></code></pre></figure>

<p>This data is considered wide since the <em><u>time</u></em> variable (represented as quarters) is structured such that each quarter represents a variable. To re-structure the time component as an individual variable, we can <em>gather</em> each quarter within one column variable and also <em>gather</em> the values associated with each quarter in a second column variable.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">long_DF</span> <span class="o">&lt;-</span> <span class="n">DF</span> <span class="o">%&gt;%</span> <span class="n">gather</span><span class="p">(</span><span class="n">Quarter</span><span class="p">,</span> <span class="n">Revenue</span><span class="p">,</span> <span class="n">Qtr.1</span><span class="o">:</span><span class="n">Qtr.4</span><span class="p">)</span>
<span class="n">head</span><span class="p">(</span><span class="n">long_DF</span><span class="p">,</span> <span class="m">24</span><span class="p">)</span>  <span class="c1"># note, for brevity, I only show the data for the first two years 
</span>
<span class="c1">## Source: local data frame [24 x 4]
## 
##    Group Year Quarter Revenue
## 1      1 2006   Qtr.1      15
## 2      1 2007   Qtr.1      12
## 3      1 2008   Qtr.1      22
## 4      1 2009   Qtr.1      10
## 5      2 2006   Qtr.1      12
## 6      2 2007   Qtr.1      16
## 7      2 2008   Qtr.1      13
## 8      2 2009   Qtr.1      23
## 9      3 2006   Qtr.1      11
## 10     3 2007   Qtr.1      13
</span><span class="err">##</span> <span class="err">..</span>   <span class="k">...</span>  <span class="k">...</span>     <span class="k">...</span>     <span class="k">...</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">These</span> <span class="n">all</span> <span class="n">produce</span> <span class="n">the</span> <span class="n">same</span> <span class="n">results</span><span class="o">:</span>
        <span class="n">DF</span> <span class="o">%&gt;%</span> <span class="n">gather</span><span class="p">(</span><span class="n">Quarter</span><span class="p">,</span> <span class="n">Revenue</span><span class="p">,</span> <span class="n">Qtr.1</span><span class="o">:</span><span class="n">Qtr.4</span><span class="p">)</span>
        <span class="n">DF</span> <span class="o">%&gt;%</span> <span class="n">gather</span><span class="p">(</span><span class="n">Quarter</span><span class="p">,</span> <span class="n">Revenue</span><span class="p">,</span> <span class="o">-</span><span class="n">Group</span><span class="p">,</span> <span class="o">-</span><span class="n">Year</span><span class="p">)</span>
        <span class="n">DF</span> <span class="o">%&gt;%</span> <span class="n">gather</span><span class="p">(</span><span class="n">Quarter</span><span class="p">,</span> <span class="n">Revenue</span><span class="p">,</span> <span class="m">3</span><span class="o">:</span><span class="m">6</span><span class="p">)</span>
        <span class="n">DF</span> <span class="o">%&gt;%</span> <span class="n">gather</span><span class="p">(</span><span class="n">Quarter</span><span class="p">,</span> <span class="n">Revenue</span><span class="p">,</span> <span class="n">Qtr.1</span><span class="p">,</span> <span class="n">Qtr.2</span><span class="p">,</span> <span class="n">Qtr.3</span><span class="p">,</span> <span class="n">Qtr.4</span><span class="p">)</span>

<span class="n">Also</span> <span class="n">note</span> <span class="n">that</span> <span class="k">if</span> <span class="n">you</span> <span class="n">do</span> <span class="n">not</span> <span class="n">supply</span> <span class="n">arguments</span> <span class="k">for</span> <span class="n">na.rm</span> <span class="n">or</span> <span class="n">convert</span> <span class="n">values</span> <span class="n">then</span> <span class="n">the</span> <span class="n">defaults</span> <span class="n">are</span> <span class="n">used</span></code></pre></figure>

<p><a href="#">Go to top</a></p>

<p><br />
<a id="separate"> </a></p>

<h2 id="useparate--functionu"><u>separate( ) function</u>:</h2>
<p><strong>Objective:</strong> Splitting a single variable into two</p>

<p><strong>Description:</strong> Many times a single column variable will capture multiple variables, or even parts of a variable you just don’t care about.  Some examples include:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">##   Grp_Ind    Yr_Mo       City_State        First_Last Extra_variable
## 1     1.a 2006_Jan      Dayton (OH) George Washington   XX01person_1
## 2     1.b 2006_Feb Grand Forks (ND)        John Adams   XX02person_2
## 3     1.c 2006_Mar       Fargo (ND)  Thomas Jefferson   XX03person_3
## 4     2.a 2007_Jan   Rochester (MN)     James Madison   XX04person_4
## 5     2.b 2007_Feb     Dubuque (IA)      James Monroe   XX05person_5
## 6     2.c 2007_Mar Ft. Collins (CO)        John Adams   XX06person_6
## 7     3.a 2008_Jan   Lake City (MN)    Andrew Jackson   XX07person_7
## 8     3.b 2008_Feb    Rushford (MN)  Martin Van Buren   XX08person_8
</span><span class="err">##</span> <span class="m">9</span>     <span class="m">3</span><span class="n">.c</span> <span class="m">2008</span><span class="n">_Mar</span>          <span class="n">Unknown</span>  <span class="n">William</span> <span class="n">Harrison</span>   <span class="n">XX09person_9</span></code></pre></figure>

<p>In each of these cases, our objective may be to <em>separate</em> characters within the variable string. This can be accomplished using the <code class="highlighter-rouge">separate()</code> function which turns a single character column into multiple columns.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">Function</span><span class="o">:</span>       <span class="n">separate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">into</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">" "</span><span class="p">,</span> <span class="n">remove</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">,</span> <span class="n">convert</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span>
<span class="n">Same</span> <span class="n">as</span><span class="o">:</span>        <span class="n">data</span> <span class="o">%&gt;%</span> <span class="n">separate</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">into</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">" "</span><span class="p">,</span> <span class="n">remove</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">,</span> <span class="n">convert</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
        <span class="n">data</span><span class="o">:</span>           <span class="n">data</span> <span class="n">frame</span>
        <span class="n">col</span><span class="o">:</span>            <span class="n">column</span> <span class="n">name</span> <span class="n">representing</span> <span class="n">current</span> <span class="n">variable</span>
        <span class="n">into</span><span class="o">:</span>           <span class="n">names</span> <span class="n">of</span> <span class="n">variables</span> <span class="n">representing</span> <span class="n">new</span> <span class="n">variables</span>
        <span class="n">sep</span><span class="o">:</span>            <span class="n">how</span> <span class="n">to</span> <span class="n">separate</span> <span class="n">current</span> <span class="n">variable</span> <span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">or</span> <span class="n">symbol</span><span class="p">)</span>
        <span class="n">remove</span><span class="o">:</span>         <span class="k">if</span> <span class="n">TRUE</span><span class="p">,</span> <span class="n">remove</span> <span class="n">input</span> <span class="n">column</span> <span class="n">from</span> <span class="n">output</span> <span class="n">data</span> <span class="n">frame</span>
        <span class="n">convert</span><span class="o">:</span>        <span class="k">if</span> <span class="n">TRUE</span> <span class="n">will</span> <span class="n">automatically</span> <span class="n">convert</span> <span class="n">values</span> <span class="n">to</span> <span class="n">logical</span><span class="p">,</span> <span class="n">integer</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">complex</span> <span class="n">or</span> 
                        <span class="n">factor</span> <span class="n">as</span> <span class="n">appropriate</span></code></pre></figure>

<p>☛ <em>This function is a complement to <a href="#unite"><code class="highlighter-rouge">unite()</code></a></em></p>

<p><strong>Example</strong></p>

<p>We can go back to our <strong>long_DF</strong> dataframe we created above in which way may desire to clean up or separate the <em>Quarter</em> variable.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">## Source: local data frame [6 x 4]
## 
##   Group Year Quarter Revenue
## 1     1 2006   Qtr.1      15
## 2     1 2007   Qtr.1      12
## 3     1 2008   Qtr.1      22
## 4     1 2009   Qtr.1      10
## 5     2 2006   Qtr.1      12
</span><span class="err">##</span> <span class="m">6</span>     <span class="m">2</span> <span class="m">2007</span>   <span class="n">Qtr.1</span>      <span class="m">16</span></code></pre></figure>

<p>By applying the <code class="highlighter-rouge">separate()</code> function we get the following:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">separate_DF</span> <span class="o">&lt;-</span> <span class="n">long_DF</span> <span class="o">%&gt;%</span> <span class="n">separate</span><span class="p">(</span><span class="n">Quarter</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">"Time_Interval"</span><span class="p">,</span> <span class="s2">"Interval_ID"</span><span class="p">))</span>
<span class="n">head</span><span class="p">(</span><span class="n">separate_DF</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>

<span class="c1">## Source: local data frame [10 x 5]
## 
##    Group Year Time_Interval Interval_ID Revenue
## 1      1 2006           Qtr           1      15
## 2      1 2007           Qtr           1      12
## 3      1 2008           Qtr           1      22
## 4      1 2009           Qtr           1      10
## 5      2 2006           Qtr           1      12
## 6      2 2007           Qtr           1      16
## 7      2 2008           Qtr           1      13
## 8      2 2009           Qtr           1      23
## 9      3 2006           Qtr           1      11
</span><span class="err">##</span> <span class="m">10</span>     <span class="m">3</span> <span class="m">2007</span>           <span class="n">Qtr</span>           <span class="m">1</span>      <span class="m">13</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">These</span> <span class="n">produce</span> <span class="n">the</span> <span class="n">same</span> <span class="n">results</span><span class="o">:</span>
        <span class="n">long_DF</span> <span class="o">%&gt;%</span> <span class="n">separate</span><span class="p">(</span><span class="n">Quarter</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">"Time_Interval"</span><span class="p">,</span> <span class="s2">"Interval_ID"</span><span class="p">))</span>
        <span class="n">long_DF</span> <span class="o">%&gt;%</span> <span class="n">separate</span><span class="p">(</span><span class="n">Quarter</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">"Time_Interval"</span><span class="p">,</span> <span class="s2">"Interval_ID"</span><span class="p">),</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">"\\."</span><span class="p">)</span></code></pre></figure>

<p><a href="#">Go to top</a></p>

<p><br />
<a id="unite"> </a></p>

<h2 id="uunite--functionu"><u>unite( ) function</u>:</h2>
<p><strong>Objective:</strong> Merging two variables into one</p>

<p><strong>Description:</strong> There may be a time in which we would like to combine the values of two variables.  The <code class="highlighter-rouge">unite()</code> function is a convenience function to paste together multiple variable values into one.  In essence, it combines two variables of a single observation into one variable.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">Function</span><span class="o">:</span>       <span class="n">unite</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="k">...</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">" "</span><span class="p">,</span> <span class="n">remove</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>
<span class="n">Same</span> <span class="n">as</span><span class="o">:</span>        <span class="n">data</span> <span class="o">%&gt;%</span> <span class="n">unite</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="k">...</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">" "</span><span class="p">,</span> <span class="n">remove</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
        <span class="n">data</span><span class="o">:</span>           <span class="n">data</span> <span class="n">frame</span>
        <span class="n">col</span><span class="o">:</span>            <span class="n">column</span> <span class="n">name</span> <span class="n">of</span> <span class="n">new</span> <span class="s2">"merged"</span> <span class="n">column</span>
        <span class="k">...</span><span class="o">:</span>            <span class="n">names</span> <span class="n">of</span> <span class="n">columns</span> <span class="n">to</span> <span class="n">merge</span>
        <span class="n">sep</span><span class="o">:</span>            <span class="n">separator</span> <span class="n">to</span> <span class="n">use</span> <span class="n">between</span> <span class="n">merged</span> <span class="n">values</span>
        <span class="n">remove</span><span class="o">:</span>         <span class="k">if</span> <span class="n">TRUE</span><span class="p">,</span> <span class="n">remove</span> <span class="n">input</span> <span class="n">column</span> <span class="n">from</span> <span class="n">output</span> <span class="n">data</span> <span class="n">frame</span></code></pre></figure>

<p>☛ <em>This function is a complement to <a href="#separate"><code class="highlighter-rouge">separate()</code></a></em></p>

<p><strong>Example</strong></p>

<p>Using the <strong>separate_DF</strong> dataframe we created above, we can re-unite the <em>Time_Interval</em> and <em>Interval_ID</em> variables we created and re-create the original <em>Quarter</em> variable we had in the <strong>long_DF</strong> dataframe.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">unite_DF</span> <span class="o">&lt;-</span> <span class="n">separate_DF</span> <span class="o">%&gt;%</span> <span class="n">unite</span><span class="p">(</span><span class="n">Quarter</span><span class="p">,</span> <span class="n">Time_Interval</span><span class="p">,</span> <span class="n">Interval_ID</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">"."</span><span class="p">)</span>
<span class="n">head</span><span class="p">(</span><span class="n">unite_DF</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>

<span class="c1">## Source: local data frame [10 x 4]
## 
##    Group Year Quarter Revenue
## 1      1 2006   Qtr.1      15
## 2      1 2007   Qtr.1      12
## 3      1 2008   Qtr.1      22
## 4      1 2009   Qtr.1      10
## 5      2 2006   Qtr.1      12
## 6      2 2007   Qtr.1      16
## 7      2 2008   Qtr.1      13
## 8      2 2009   Qtr.1      23
## 9      3 2006   Qtr.1      11
</span><span class="err">##</span> <span class="m">10</span>     <span class="m">3</span> <span class="m">2007</span>   <span class="n">Qtr.1</span>      <span class="m">13</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">These</span> <span class="n">produce</span> <span class="n">the</span> <span class="n">same</span> <span class="n">results</span><span class="o">:</span>
        <span class="n">separate_DF</span> <span class="o">%&gt;%</span> <span class="n">unite</span><span class="p">(</span><span class="n">Quarter</span><span class="p">,</span> <span class="n">Time_Interval</span><span class="p">,</span> <span class="n">Interval_ID</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">"_"</span><span class="p">)</span>
        <span class="n">separate_DF</span> <span class="o">%&gt;%</span> <span class="n">unite</span><span class="p">(</span><span class="n">Quarter</span><span class="p">,</span> <span class="n">Time_Interval</span><span class="p">,</span> <span class="n">Interval_ID</span><span class="p">)</span>

<span class="n">If</span> <span class="n">no</span> <span class="n">spearator</span> <span class="n">is</span> <span class="n">identified</span><span class="p">,</span> <span class="s2">"_"</span> <span class="n">will</span> <span class="n">automatically</span> <span class="n">be</span> <span class="n">used</span></code></pre></figure>

<p><a href="#">Go to top</a></p>

<p><br />
<a id="spread"> </a></p>

<h2 id="uspread--functionu"><u>spread( ) function</u>:</h2>

<p><strong>Objective:</strong> Reshaping long format to wide format</p>

<p><strong>Description:</strong> There are times when we are required to turn long formatted data into wide formatted data.  The <code class="highlighter-rouge">spread()</code> function spreads a key-value pair across multiple columns.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">Function</span><span class="o">:</span>       <span class="n">spread</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">NA</span><span class="p">,</span> <span class="n">convert</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span>
<span class="n">Same</span> <span class="n">as</span><span class="o">:</span>        <span class="n">data</span> <span class="o">%&gt;%</span> <span class="n">spread</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">NA</span><span class="p">,</span> <span class="n">convert</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
        <span class="n">data</span><span class="o">:</span>           <span class="n">data</span> <span class="n">frame</span>
        <span class="n">key</span><span class="o">:</span>            <span class="n">column</span> <span class="n">values</span> <span class="n">to</span> <span class="n">convert</span> <span class="n">to</span> <span class="n">multiple</span> <span class="n">columns</span>
        <span class="n">value</span><span class="o">:</span>          <span class="n">single</span> <span class="n">column</span> <span class="n">values</span> <span class="n">to</span> <span class="n">convert</span> <span class="n">to</span> <span class="n">multiple</span> <span class="n">columns</span><span class="s1">' values 
        fill:           If there isn'</span><span class="n">t</span> <span class="n">a</span> <span class="n">value</span> <span class="k">for</span> <span class="n">every</span> <span class="n">combination</span> <span class="n">of</span> <span class="n">the</span> <span class="n">other</span> <span class="n">variables</span> <span class="n">and</span> <span class="n">the</span> <span class="n">key</span> 
                        <span class="n">column</span><span class="p">,</span> <span class="n">this</span> <span class="n">value</span> <span class="n">will</span> <span class="n">be</span> <span class="n">substituted</span>
        <span class="n">convert</span><span class="o">:</span>        <span class="k">if</span> <span class="n">TRUE</span> <span class="n">will</span> <span class="n">automatically</span> <span class="n">convert</span> <span class="n">values</span> <span class="n">to</span> <span class="n">logical</span><span class="p">,</span> <span class="n">integer</span><span class="p">,</span> <span class="n">numeric</span><span class="p">,</span> <span class="n">complex</span> <span class="n">or</span> 
                        <span class="n">factor</span> <span class="n">as</span> <span class="n">appropriate</span></code></pre></figure>

<p>☛ <em>This function is a complement to <a href="#gather"><code class="highlighter-rouge">gather()</code></a></em></p>

<p><strong>Example</strong></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">wide_DF</span> <span class="o">&lt;-</span> <span class="n">unite_DF</span> <span class="o">%&gt;%</span> <span class="n">spread</span><span class="p">(</span><span class="n">Quarter</span><span class="p">,</span> <span class="n">Revenue</span><span class="p">)</span>
<span class="n">head</span><span class="p">(</span><span class="n">wide_DF</span><span class="p">,</span> <span class="m">24</span><span class="p">)</span>

<span class="c1">## Source: local data frame [12 x 6]
## 
##    Group Year Qtr.1 Qtr.2 Qtr.3 Qtr.4
## 1      1 2006    15    16    19    17
## 2      1 2007    12    13    27    23
## 3      1 2008    22    22    24    20
## 4      1 2009    10    14    20    16
## 5      2 2006    12    13    25    18
## 6      2 2007    16    14    21    19
## 7      2 2008    13    11    29    15
## 8      2 2009    23    20    26    20
## 9      3 2006    11    12    22    16
## 10     3 2007    13    11    27    21
## 11     3 2008    17    12    23    19
</span><span class="err">##</span> <span class="m">12</span>     <span class="m">3</span> <span class="m">2009</span>    <span class="m">14</span>     <span class="m">9</span>    <span class="m">31</span>    <span class="m">24</span></code></pre></figure>

<p><a href="#">Go to top</a></p>

<p><br /></p>

<p><a id="resources"> </a></p>

<h2 id="additional-resources">Additional Resources</h2>

<ul>
  <li>Data wrangling <a href="Data_Wrangling_MU">presentation</a> I gave at Miami University</li>
  <li>R Studio’s <a href="http://www.rstudio.com/resources/webinars/">Data wrangling with R and RStudio webinar</a></li>
  <li>R Studio’s <a href="https://github.com/rstudio/webinars/blob/master/2015-01/wrangling-webinar.pdf">Data wrangling GitHub repository</a></li>
  <li>R Studio’s <a href="http://www.rstudio.com/resources/cheatsheets/">Data wrangling cheat sheet</a></li>
  <li>Hadley Wickham’s paper on <a href="http://vita.had.co.nz/papers/tidy-data.html">Tidy Data</a></li>
</ul>

<p><a href="#">Go to top</a></p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">

      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
        <center>
          <li>
            <a href="https://github.com/bradleyboehmke">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>
            </a>
            &nbsp;
            <a href="http://www.twitter.com/bradleyboehmke">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>
            </a>
            &nbsp;
            <a href="https://www.linkedin.com/in/brad-boehmke-ph-d-9b0a257">
              <span class="icon  icon--linkedin">
                <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"  width="25" height="25" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path fill="#828282" d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51V7.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"/>
                </svg>
              </span>
            </a>
          </li>

        </ul>
        </center>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text"></p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
