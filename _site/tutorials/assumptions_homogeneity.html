<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Bradley Boehmke</title>
    <meta name="description" content="">

    <link rel="stylesheet" href="http://bradleyboehmke.github.io//css/main.css">
    <link rel="canonical" href="http://bradleyboehmke.github.io/http://bradleyboehmke.github.io//tutorials/assumptions_homogeneity">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="http://bradleyboehmke.github.io/">Bradley Boehmke</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="http://bradleyboehmke.github.io//about/">About</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://bradleyboehmke.github.io//categoryview/">Archive</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://bradleyboehmke.github.io//cv/">CV</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://bradleyboehmke.github.io//tutorials/">Tutorials</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://bradleyboehmke.github.io//tutorials/scraping_with_apis_DSCOE.Rmd">Scraping Data with APIs</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <article class="post-content">
    <p><a href="index">R Vocab Topics</a> » <a href="analytics">Analytics</a> » <a href="exploratory">Exploratory data analysis</a> » <a href="assumptions">Assessing assumptions</a> » Homogeneity</p>

<p><br /></p>

<p>The assumption of homogeneity of variance means that the level of variance for a particular variable is constant across the sample. If you’ve collected groups of data then this means that the variance of your outcome variable(s) should be the same in each of these groups (i.e. across schools, years, testing groups or predicted values).</p>

<p>The assumption of homogeneity is important for ANOVA testing and in regression models. In ANOVA, when homogeneity of variance is violated there is a greater probability of falsely rejecting the null hypothesis.  In regression models, the assumption comes in to play with regards to residuals (aka errors). In both cases it useful to test for homogeneity and that’s what this tutorial covers. I’ll illustrate how to assess homogeneity of variance through:</p>

<ol>
  <li><a href="#visualization">Visualization</a></li>
  <li><a href="#levene">Levene’s Test</a></li>
  <li><a href="#bartlett">Bartlett’s Test</a></li>
  <li><a href="#fligner">Fligner-Killeen’s Test</a></li>
</ol>

<p><br /></p>

<h2 id="visualization">Visualizing Homogeneity</h2>
<p>Scatter plots are a useful way to look at the variance of a data and are, typically, our first step in assessing homogeneity. We can illustrate with some <a href="https://github.com/bradleyboehmke/bradleyboehmke.github.io/blob/master/public/data/Golf%20Stats.xlsx">golf data</a> provided by <a href="http://espn.go.com/golf/statistics">ESPN</a>. Here we are assessing the number of birdies players score versus the rank of the player (fig 1) and the number of events played (fig 2).  For both figures I added the trend line which makes it easier to assess the variance (or spread of points). In figure 1 it appears that the dots are spread out fairly evenly across the line; this is what is meant by homogeneity of variance.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">readxl</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="n">golf</span> <span class="o">&lt;-</span> <span class="n">read_excel</span><span class="p">(</span><span class="s2">"Data/Assumptions/Golf Stats.xlsx"</span><span class="p">,</span> <span class="n">sheet</span> <span class="o">=</span> <span class="s2">"2011"</span><span class="p">)</span>

<span class="n">ggplot</span><span class="p">(</span><span class="n">golf</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Rank</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Birdies</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_point</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s2">"lm"</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Figure 1: Number of Birdies versus Player Rank"</span><span class="p">)</span></code></pre></figure>

<p><img src="/public/images/analytics/homogeneity/unnamed-chunk-1-1.png" style="display: block; margin: auto;" /></p>

<p>In figure 2, however, the variance appears to increase as the number of events played increases.  This is an example of heterogeneity of variance, meaning that the variance (or spread) is not consistent across the ranges of values.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">golf</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">Events</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Birdies</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_point</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s2">"lm"</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span> <span class="o">+</span>
         <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Figure 2: Birdies versus Number of Events Played"</span><span class="p">)</span></code></pre></figure>

<p><img src="/public/images/analytics/homogeneity/unnamed-chunk-2-1.png" style="display: block; margin: auto;" /></p>

<p>An alternative vizualization is the boxplot. This is commonly used to compare groupings against one-another. In this case we may want to assess how the number of birdies differ among players who have won zero, one, and two tournaments. This plot illustrates that the number of birdies vary widely for players who have no tournament wins.  However, players who have one and two tournament wins have an increasing median number of birdies achieved and less variance. This is logical as we would expect players that win more tournaments to have scored more birdies and to be more consistent with the number of birdies scored.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">golf</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">Wins</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Birdies</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_boxplot</span><span class="p">()</span> <span class="o">+</span>
         <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Number of Birdies by Number of Tournaments Won"</span><span class="p">)</span></code></pre></figure>

<p><img src="/public/images/analytics/homogeneity/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /></p>

<p>Keep in mind that visualizing variance provides indications rather than statistical confirmation of homogeneity (or heterogeneity). To confirm we can perform statistical tests which I cover next.</p>

<p><a href="#top">Go to top</a></p>

<p><br /></p>

<h2 id="bartlett">Bartlett’s Test</h2>
<p>Bartlett’s test is used to test if $k$ samples are from populations with equal variances; however, Bartlett’s test is sensitive to deviations from normality.  If you’ve verified that your data is normally distributed then Bartlett’s test is a good first test but if your data is non-normal than you should <u>always</u> verify results from Bartlett’s test to results from <a href="#levene">Levene’s</a> and <a href="#fligner">Flinger-Killeen’s</a> tests as there is a good chance you will get a false positive.</p>

<p>When testing one independent variable, such as the variance of birdies across tournament wins we use the <code class="highlighter-rouge">bartlett.test()</code> function. For all the tests that follow, the null hypothesis is that all populations variances are equal, the alternative hypothesis is that at least two of them differ. Consequently, $p$-values less than 0.1, 0.05, 0.001 (depending on your desired threshold) suggest variances are significantly different and the homogeneity of variance assumption has been violated. We can illustrate by testing if the variance in birdies is different among the following groups - zero tournament wins, one win, and two wins.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># feed it data via a data frame
</span><span class="n">bartlett.test</span><span class="p">(</span><span class="n">Birdies</span> <span class="o">~</span> <span class="n">Wins</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">golf</span><span class="p">)</span>
<span class="c1">## 
## 	Bartlett test of homogeneity of variances
## 
## data:  Birdies by Wins
## Bartlett's K-squared = 4.2261, df = 2, p-value = 0.1209
</span>
<span class="c1"># can also feed it two vectors
</span><span class="n">bartlett.test</span><span class="p">(</span><span class="n">golf</span><span class="o">$</span><span class="n">Birdies</span><span class="p">,</span> <span class="n">golf</span><span class="o">$</span><span class="n">Wins</span><span class="p">)</span>
<span class="c1">## 
## 	Bartlett test of homogeneity of variances
## 
## data:  golf$Birdies and golf$Wins
</span><span class="err">##</span> <span class="n">Bartlett</span><span class="err">'</span><span class="n">s</span> <span class="n">K</span><span class="o">-</span><span class="n">squared</span> <span class="o">=</span> <span class="m">4.2261</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">p</span><span class="o">-</span><span class="n">value</span> <span class="o">=</span> <span class="m">0.1209</span></code></pre></figure>

<p><a href="#top">Go to top</a></p>

<p><br /></p>

<h2 id="levene">Levene’s Test</h2>
<p>The Levene’s test is slightly more robust to departures from normality than the Bartlett’s test. Levene’s performs a one-way ANOVA conducted on the deviation scores; that is, the absolute difference between each score and the mean of the group from which it came.<sup id="fnref:glass"><a href="#fn:glass" class="footnote">1</a></sup>  To test, we use <code class="highlighter-rouge">leveneTest()</code> from the <code class="highlighter-rouge">car</code> package. By default <code class="highlighter-rouge">leveneTest()</code> will test variance around the median but you can override this by using the <code class="highlighter-rouge">center = mean</code> argument. In the tests below, we see that both tests have $p &lt; 0.1$ and the first test (testing variance around the median) has a $p &lt; 0.05$. This differs from the results from the Bartlett test above, likely because of non-normality in our data.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">car</span><span class="p">)</span>

<span class="c1"># by default leveneTest will test variance around the median
</span><span class="n">leveneTest</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">golf</span><span class="o">$</span><span class="n">Birdies</span><span class="p">,</span> <span class="n">group</span> <span class="o">=</span> <span class="n">golf</span><span class="o">$</span><span class="n">Wins</span><span class="p">)</span>
<span class="c1">## Levene's Test for Homogeneity of Variance (center = median)
##        Df F value  Pr(&gt;F)  
## group   2  3.1417 0.04544 *
##       192                  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
</span>
<span class="c1"># can override default with center = mean to test variance around the mean
</span><span class="n">leveneTest</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">golf</span><span class="o">$</span><span class="n">Birdies</span><span class="p">,</span> <span class="n">group</span> <span class="o">=</span> <span class="n">golf</span><span class="o">$</span><span class="n">Wins</span><span class="p">,</span> <span class="n">center</span> <span class="o">=</span> <span class="n">mean</span><span class="p">)</span>
<span class="c1">## Levene's Test for Homogeneity of Variance (center = mean)
##        Df F value  Pr(&gt;F)  
## group   2  2.7079 0.06922 .
##       192                  
## ---
</span><span class="err">##</span> <span class="n">Signif.</span> <span class="n">codes</span><span class="o">:</span>  <span class="m">0</span> <span class="s1">'***'</span> <span class="m">0.001</span> <span class="s1">'**'</span> <span class="m">0.01</span> <span class="s1">'*'</span> <span class="m">0.05</span> <span class="s1">'.'</span> <span class="m">0.1</span> <span class="s1">' '</span> <span class="m">1</span></code></pre></figure>

<p><a href="#top">Go to top</a></p>

<p><br /></p>

<h2 id="fligner">Fligner-Killeen’s Test</h2>
<p>As previously stated, Bartlett’s test can provide false positive results when the data is non-normal. Also, when the sample size is large, small differences in group variances can produce a statistically significant Levene’s test (similar to the Shapiro-Wilk test for normality). Fligner-Killeen’s test is a non-parametric test which is robust to departures from normality and provides a good alternative or double check for the previous parametric tests.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">fligner.test</span><span class="p">(</span><span class="n">Birdies</span> <span class="o">~</span> <span class="n">Wins</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">golf</span><span class="p">)</span>
<span class="c1">## 
## 	Fligner-Killeen test of homogeneity of variances
## 
## data:  Birdies by Wins
## Fligner-Killeen:med chi-squared = 7.7662, df = 2, p-value =
</span><span class="err">##</span> <span class="m">0.02059</span></code></pre></figure>

<p><br /></p>

<p>Similar to the assumption of normality, when we test for violations of constant variance we should not rely on only one approach to assess our data. Rather, we should understand the variance visually and by using multiple testing procedures to come to our conclusion of whether or not homogeneity of variance holds for our data.</p>

<p><a href="#top">Go to top</a></p>

<p><br /></p>

<div class="footnotes">
  <ol>
    <li id="fn:glass">
      <p>See <a href="">Levene (1960)</a> and <a href="http:www.jstor.org/stable/1161802?seq=1#page_scan_tab_contents">Glass (1966)</a> for further discussion. <a href="#fnref:glass" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">

      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
        <center>
          <li>
            <a href="https://github.com/bradleyboehmke">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>
            </a>
            &nbsp;
            <a href="http://www.twitter.com/bradleyboehmke">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>
            </a>
            &nbsp;
            <a href="https://www.linkedin.com/in/brad-boehmke-ph-d-9b0a257">
              <span class="icon  icon--linkedin">
                <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"  width="25" height="25" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path fill="#828282" d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51V7.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"/>
                </svg>
              </span>
            </a>
          </li>

        </ul>
        </center>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text"></p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
