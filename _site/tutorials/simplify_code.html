<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Bradley Boehmke</title>
    <meta name="description" content="">

    <link rel="stylesheet" href="http://bradleyboehmke.github.io//css/main.css">
    <link rel="canonical" href="http://bradleyboehmke.github.io/http://bradleyboehmke.github.io//tutorials/simplify_code">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="http://bradleyboehmke.github.io/">Bradley Boehmke</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="http://bradleyboehmke.github.io//about/">About</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://bradleyboehmke.github.io//categoryview/">Archive</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://bradleyboehmke.github.io//cv/">CV</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://bradleyboehmke.github.io//tutorials/">Tutorials</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://bradleyboehmke.github.io//tutorials/scraping_with_apis_DSCOE.Rmd">Scraping Data with APIs</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <article class="post-content">
    <p><a href="index">R Vocab Topics</a> » Simplify your code with <code class="highlighter-rouge">%&gt;%</code></p>

<p><br /></p>

<p>Removing duplication is an important principle to keep in mind with your code; however, equally important is to keep your code efficient and readable. Efficiency is often accomplished by leveraging functions and control statements in your code. However, efficiency also includes eliminating the creation and saving of unnecessary objects that often result when you are trying to make your code more readable, clear, and explicit. Consequently, writing code that is simple, readable, <em>and</em> efficient is often considered contradictory. For this reason, the <code class="highlighter-rouge">magrittr</code> package is a powerful tool to have in your data wrangling toolkit.</p>

<p>The <a href="https://cran.r-project.org/web/packages/magrittr/index.html"><code class="highlighter-rouge">magrittr</code></a> package was created by <a href="https://twitter.com/stefanbache">Stefan Milton Bache</a> and, in Stefan’s words, has two primary aims: “to decrease development time and to improve readability and maintainability of code.” Hence, it aims to increase efficiency and improve readability; and in the process it greatly simplifies your code. The following covers the basics of the <code class="highlighter-rouge">magrittr</code> toolkit.</p>

<p><br /></p>

<h2 id="pipe--operator">Pipe (%&gt;%) Operator</h2>
<p>The principal function provided by the <code class="highlighter-rouge">magrittr</code> package is <code class="highlighter-rouge">%&gt;%</code>, or what’s called the “pipe” operator. This operator will forward a value, or the result of an expression, into the next function call/expression. For instance a function to filter data can be written as:</p>

<p align="center">

<code>filter(data, variable == numeric_value)</code>

<br />

or

<br />

<code>data %&gt;% filter(variable == numeric_value)</code>

</p>

<p>Both functions complete the same task and the benefit of using <code class="highlighter-rouge">%&gt;%</code> may not be immediately evident; however, when you desire to perform multiple functions its advantage becomes obvious. For instance, if we want to filter some data, group it by categories, summarize it, and then order the summarized results we could write it out three different ways. Don’t worry, you’ll learn how to operate these specific functions in the next section.</p>

<p><u>Nested Option</u>:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">magrittr</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>

<span class="n">arrange</span><span class="p">(</span>
   <span class="n">summarize</span><span class="p">(</span>
       <span class="n">group_by</span><span class="p">(</span>
           <span class="n">filter</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">carb</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">),</span>
           <span class="n">cyl</span>
          <span class="p">),</span>
       <span class="n">Avg_mpg</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span>
      <span class="p">),</span>
   <span class="n">desc</span><span class="p">(</span><span class="n">Avg_mpg</span><span class="p">)</span>
 <span class="p">)</span>
<span class="c1">## Source: local data frame [3 x 2]
## 
##     cyl Avg_mpg
##   (dbl)   (dbl)
## 1     4   25.90
## 2     6   19.74
</span><span class="err">##</span> <span class="m">3</span>     <span class="m">8</span>   <span class="m">15.10</span></code></pre></figure>

<p>This first option is considered a “nested” option such that functions are nested within one another. Historically, this has been the traditional way of integrating code; however, it becomes extremely difficult to read what exactly the code is doing and it also becomes easier to make mistakes when making updates to your code. Although not in violation of the DRY principle, it definitely violates the basic principle of readability and clarity, which makes communication of your analysis more difficult.  To make things more readable, people often move to the following approach…</p>

<p><u>Multiple Object Option</u>:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">a</span> <span class="o">&lt;-</span> <span class="n">filter</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">carb</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">&lt;-</span> <span class="n">group_by</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">cyl</span><span class="p">)</span>
<span class="n">c</span> <span class="o">&lt;-</span> <span class="n">summarise</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">Avg_mpg</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">mpg</span><span class="p">))</span>
<span class="n">d</span> <span class="o">&lt;-</span> <span class="n">arrange</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">desc</span><span class="p">(</span><span class="n">Avg_mpg</span><span class="p">))</span>
<span class="n">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="c1">## Source: local data frame [3 x 2]
## 
##     cyl Avg_mpg
##   (dbl)   (dbl)
## 1     4   25.90
## 2     6   19.74
</span><span class="err">##</span> <span class="m">3</span>     <span class="m">8</span>   <span class="m">15.10</span></code></pre></figure>

<p>This second option helps in making the data wrangling steps more explicit and obvious but definitely violates the DRY principle. By sequencing multiple functions in this way you are likely saving multiple outputs that are not very informative to you or others; rather, the only reason you save them is to insert them into the next function to eventually get the final output you desire. This inevitably creates unnecessary copies and wrecks havoc on properly managing your objects…basically it results in a global environment charlie foxtrot! To provide the same readability (or even better), we can use <code class="highlighter-rouge">%&gt;%</code> to string these arguments together without unnecessary object creation…</p>

<p><u>%&gt;% Option</u>:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">filter</span><span class="p">(</span><span class="n">carb</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">group_by</span><span class="p">(</span><span class="n">cyl</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">summarise</span><span class="p">(</span><span class="n">Avg_mpg</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">mpg</span><span class="p">))</span> <span class="o">%&gt;%</span>
        <span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">Avg_mpg</span><span class="p">))</span>
<span class="c1">## Source: local data frame [3 x 2]
## 
##     cyl Avg_mpg
##   (dbl)   (dbl)
## 1     4   25.90
## 2     6   19.74
</span><span class="err">##</span> <span class="m">3</span>     <span class="m">8</span>   <span class="m">15.10</span></code></pre></figure>

<p>This final option which integrates <code class="highlighter-rouge">%&gt;%</code> operators makes for more efficient <em>and</em> legible code. Its efficient in that it doesn’t save unncessary objects (as in option 2) and performs as effectively (as both option 1 &amp; 2) but makes your code more readable in the process. Its legible in that you can read this as you would read normal prose (we read the <code class="highlighter-rouge">%&gt;%</code> as <em>“and then”</em>)- “take <code class="highlighter-rouge">mtcars</code> <em>and then</em> <code class="highlighter-rouge">filter</code> <em>and then</em> <code class="highlighter-rouge">group by</code> <em>and then</em> <code class="highlighter-rouge">summarize</code> <em>and then</em> <code class="highlighter-rouge">arrange</code>.”</p>

<p>And since R is a functional programming language, meaning that everything you do is basically built on functions, you can use the pipe operator to feed into just about any argument call. For example, we can pipe into a linear regression function and then get the summary of the regression parameters. Note in this case I insert “<code class="highlighter-rouge">data = .</code>” into the <code class="highlighter-rouge">lm()</code> function. When using the <code class="highlighter-rouge">%&gt;%</code> operator the default is the argument that you are forwarding will go in as the <strong>first</strong> argument of the function that follows the <code class="highlighter-rouge">%&gt;%</code>.  However, in some functions the argument you are forwarding does not go into the default first position. In these cases, you place “.” to signal which argument you want the forwarded expression to go to.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">filter</span><span class="p">(</span><span class="n">carb</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">lm</span><span class="p">(</span><span class="n">mpg</span> <span class="o">~</span> <span class="n">cyl</span> <span class="o">+</span> <span class="n">hp</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="err">.</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">summary</span><span class="p">()</span>
<span class="c1">## 
## Call:
## lm(formula = mpg ~ cyl + hp, data = .)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.6163 -1.4162 -0.1506  1.6181  5.2021 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 35.67647    2.28382  15.621 2.16e-13 ***
## cyl         -2.22014    0.52619  -4.219 0.000353 ***
## hp          -0.01414    0.01323  -1.069 0.296633    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.689 on 22 degrees of freedom
## Multiple R-squared:  0.7601,	Adjusted R-squared:  0.7383 
</span><span class="err">##</span> <span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="o">:</span> <span class="m">34.85</span> <span class="n">on</span> <span class="m">2</span> <span class="n">and</span> <span class="m">22</span> <span class="n">DF</span><span class="p">,</span>  <span class="n">p</span><span class="o">-</span><span class="n">value</span><span class="o">:</span> <span class="m">1.516e-07</span></code></pre></figure>

<p>You can also use <code class="highlighter-rouge">%&gt;%</code> to feed into plots:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">filter</span><span class="p">(</span><span class="n">carb</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">qplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">wt</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="err">.</span><span class="p">)</span></code></pre></figure>

<p><img src="/public/images/dataWrangling/unnamed-chunk-5-1.png" alt="Pipe into a plot" align="middle" vspace="25" /></p>

<p>You will also find that the <code class="highlighter-rouge">%&gt;%</code> operator is now being built into packages to make programming much easier.  For instance, in the tutorials where I illustrate how to <a href="http://bradleyboehmke.github.io/tutorials/tidyr">reshape</a> and <a href="http://bradleyboehmke.github.io/tutorials/dplyr">transform</a> your data with the <code class="highlighter-rouge">dplyr</code> and <code class="highlighter-rouge">tidyr</code> packages, you will see that the <code class="highlighter-rouge">%&gt;%</code> operator is already built into these packages. It is also built into the <code class="highlighter-rouge">ggvis</code> and <code class="highlighter-rouge">dygraphs</code> packages (visualization packages), the <code class="highlighter-rouge">httr</code> package (which I covered in the <a href="http://bradleyboehmke.github.io/tutorials/scraping_data">data scraping tutorials</a>), and a growing number of newer packages.</p>

<p><br /></p>

<h2 id="additional-functions">Additional Functions</h2>
<p>In addition to the <code class="highlighter-rouge">%&gt;%</code> operator, <code class="highlighter-rouge">magrittr</code> provides several additional functions which make operations such as addition, multiplication, logical operators, re-naming, etc. more pleasant when composing chains using the <code class="highlighter-rouge">%&gt;%</code> operator. Some examples follow but you can see the current list of the available aliased functions by typing <code class="highlighter-rouge">?magrittr::add</code> in your console.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># subset with extract
</span><span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">extract</span><span class="p">(,</span> <span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">head</span>
<span class="c1">##                    mpg cyl disp  hp
## Mazda RX4         21.0   6  160 110
## Mazda RX4 Wag     21.0   6  160 110
## Datsun 710        22.8   4  108  93
## Hornet 4 Drive    21.4   6  258 110
## Hornet Sportabout 18.7   8  360 175
## Valiant           18.1   6  225 105
</span>
<span class="c1"># add, subtract, multiply, divide and other operations are available
</span><span class="n">mtcars</span> <span class="o">%&gt;%</span> 
        <span class="n">extract</span><span class="p">(,</span> <span class="s2">"mpg"</span><span class="p">)</span> <span class="o">%&gt;%</span> 
        <span class="n">multiply_by</span><span class="p">(</span><span class="m">5</span><span class="p">)</span>
<span class="c1">##  [1] 105.0 105.0 114.0 107.0  93.5  90.5  71.5 122.0 114.0  96.0  89.0
## [12]  82.0  86.5  76.0  52.0  52.0  73.5 162.0 152.0 169.5 107.5  77.5
## [23]  76.0  66.5  96.0 136.5 130.0 152.0  79.0  98.5  75.0 107.0
</span>
<span class="c1"># logical assessments and filters are available
</span><span class="n">mtcars</span> <span class="o">%&gt;%</span> 
        <span class="n">extract</span><span class="p">(,</span> <span class="s2">"cyl"</span><span class="p">)</span> <span class="o">%&gt;%</span> 
        <span class="n">equals</span><span class="p">(</span><span class="m">4</span><span class="p">)</span>
<span class="c1">##  [1] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE
## [12] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE
## [23] FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE  TRUE
</span>
<span class="c1"># renaming columns and rows is available
</span><span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">head</span> <span class="o">%&gt;%</span>
        <span class="n">set_colnames</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Col"</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">11</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">""</span><span class="p">))</span>
<span class="c1">##                   Col1 Col2 Col3 Col4 Col5  Col6  Col7 Col8 Col9 Col10 Col11
## Mazda RX4         21.0    6  160  110 3.90 2.620 16.46    0    1     4     4
## Mazda RX4 Wag     21.0    6  160  110 3.90 2.875 17.02    0    1     4     4
## Datsun 710        22.8    4  108   93 3.85 2.320 18.61    1    1     4     1
## Hornet 4 Drive    21.4    6  258  110 3.08 3.215 19.44    1    0     3     1
## Hornet Sportabout 18.7    8  360  175 3.15 3.440 17.02    0    0     3     2
</span><span class="err">##</span> <span class="n">Valiant</span>           <span class="m">18.1</span>    <span class="m">6</span>  <span class="m">225</span>  <span class="m">105</span> <span class="m">2.76</span> <span class="m">3.460</span> <span class="m">20.22</span>    <span class="m">1</span>    <span class="m">0</span>     <span class="m">3</span>     <span class="m">1</span></code></pre></figure>

<p><br /></p>

<h2 id="additional-pipe-operators">Additional Pipe Operators</h2>
<p><code class="highlighter-rouge">magrittr</code> also offers some alternative pipe operators. Some functions, such as plotting functions, will cause the string of piped arguments to terminate.  The tee (<code class="highlighter-rouge">%T&gt;%</code>) operator allows you to continue piping functions that normally cause termination.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># normal piping terminates with the plot() function resulting in
# NULL results for the summary() function
</span><span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">filter</span><span class="p">(</span><span class="n">carb</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">extract</span><span class="p">(,</span> <span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">plot</span><span class="p">()</span> <span class="o">%&gt;%</span>
        <span class="n">summary</span><span class="p">()</span></code></pre></figure>

<p><img src="/public/images/dataWrangling/unnamed-chunk-7-1.png" alt="Terminating at a plot" align="middle" vspace="25" /></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">## Length  Class   Mode 
</span><span class="err">##</span>      <span class="m">0</span>   <span class="n">NULL</span>   <span class="n">NULL</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># inserting %T&gt;% allows you to plot and perform the functions that 
# follow the plotting function
</span><span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">filter</span><span class="p">(</span><span class="n">carb</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">extract</span><span class="p">(,</span> <span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">)</span> <span class="o">%</span><span class="n">T</span><span class="o">&gt;%</span>
        <span class="n">plot</span><span class="p">()</span> <span class="o">%&gt;%</span>
        <span class="n">summary</span><span class="p">()</span></code></pre></figure>

<p><img src="/public/images/dataWrangling/unnamed-chunk-8-1.png" alt="Piping through a plot" align="middle" vspace="25" /></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">##       mpg             cyl            disp             hp       
##  Min.   :10.40   Min.   :4.00   Min.   : 75.7   Min.   : 52.0  
##  1st Qu.:15.20   1st Qu.:6.00   1st Qu.:146.7   1st Qu.:110.0  
##  Median :17.80   Median :8.00   Median :275.8   Median :175.0  
##  Mean   :18.62   Mean   :6.64   Mean   :257.7   Mean   :163.7  
##  3rd Qu.:21.00   3rd Qu.:8.00   3rd Qu.:351.0   3rd Qu.:205.0  
</span><span class="err">##</span>  <span class="n">Max.</span>   <span class="o">:</span><span class="m">30.40</span>   <span class="n">Max.</span>   <span class="o">:</span><span class="m">8.00</span>   <span class="n">Max.</span>   <span class="o">:</span><span class="m">472.0</span>   <span class="n">Max.</span>   <span class="o">:</span><span class="m">335.0</span></code></pre></figure>

<p>The compound assignment <code class="highlighter-rouge">%&lt;&gt;%</code> operator is used to update a value by first piping it into one or more expressions, and then assigning the result. For instance, let’s say you want to transform the <code class="highlighter-rouge">mpg</code> variable in the <code class="highlighter-rouge">mtcars</code> data frame to a square root measurement. Using <code class="highlighter-rouge">%&lt;&gt;%</code> will perform the functions to the right of <code class="highlighter-rouge">%&lt;&gt;%</code> and save the changes these functions perform to the variable or data frame called to the left of <code class="highlighter-rouge">%&lt;&gt;%</code>.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># note that mpg is in its typical measurement
</span><span class="n">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>
<span class="c1">##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
</span>
<span class="c1"># we can square root mpg and save this change using %&lt;&gt;%
</span><span class="n">mtcars</span><span class="o">$</span><span class="n">mpg</span> <span class="o">%&lt;&gt;%</span> <span class="n">sqrt</span>

<span class="n">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>
<span class="c1">##                        mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         4.582576   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     4.582576   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        4.774935   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    4.626013   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 4.324350   8  360 175 3.15 3.440 17.02  0  0    3    2
</span><span class="err">##</span> <span class="n">Valiant</span>           <span class="m">4.254409</span>   <span class="m">6</span>  <span class="m">225</span> <span class="m">105</span> <span class="m">2.76</span> <span class="m">3.460</span> <span class="m">20.22</span>  <span class="m">1</span>  <span class="m">0</span>    <span class="m">3</span>    <span class="m">1</span></code></pre></figure>

<p>Some functions (e.g. lm, aggregate, cor) have a data argument, which allows the direct use of names inside the data as part of the call. The exposition (<code class="highlighter-rouge">%$%</code>) operator is useful when you want to pipe a dataframe, which may contain many columns, into a function that is only applied to some of the columns.  For example, the correlation (<code class="highlighter-rouge">cor</code>) function only requires an <code class="highlighter-rouge">x</code> and <code class="highlighter-rouge">y</code> argument so if you pipe the <code class="highlighter-rouge">mtcars</code> data into the <code class="highlighter-rouge">cor</code> function using <code class="highlighter-rouge">%&gt;%</code> you will get an error because <code class="highlighter-rouge">cor</code> doesn’t know how to handle <code class="highlighter-rouge">mtcars</code>. However, using <code class="highlighter-rouge">%$%</code> allows you to say “take this dataframe and then perform <code class="highlighter-rouge">cor()</code> on these specified columns within <code class="highlighter-rouge">mtcars</code>.”</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># regular piping results in an error
</span><span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">subset</span><span class="p">(</span><span class="n">vs</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">cor</span><span class="p">(</span><span class="n">mpg</span><span class="p">,</span> <span class="n">wt</span><span class="p">)</span>
<span class="c1">## Error in pmatch(use, c("all.obs", "complete.obs", "pairwise.complete.obs", : object 'wt' not found
</span>
<span class="c1"># using %$% allows you to specify variables of interest
</span><span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">subset</span><span class="p">(</span><span class="n">vs</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span> <span class="o">%$%</span>
        <span class="n">cor</span><span class="p">(</span><span class="n">mpg</span><span class="p">,</span> <span class="n">wt</span><span class="p">)</span>
<span class="err">##</span> <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="m">-0.830671</span></code></pre></figure>

<p><br /></p>

<h2 id="additional-resources">Additional Resources</h2>
<p>The <code class="highlighter-rouge">magrittr</code> package and its pipe operators are a great tool for making your code simple, efficient, and readable. There are limitations, or at least suggestions, on when and how you should use the operators. Garrett Grolemund and Hadley Wickham offer some advice on the proper use of pipe operators in their <a href="http://r4ds.had.co.nz/">R for Data Science</a> book. However, the <code class="highlighter-rouge">%&gt;%</code> has greatly transformed our ability to write “simplified” code in R. As the pipe gains in popularity you will likely find it in more future packages and being familiar will likely result in better communication of your code.</p>

<p>Some additional resources regarding <code class="highlighter-rouge">magrittr</code> and the pipe operators you may find useful:</p>

<ul>
  <li>The <code class="highlighter-rouge">magrittr</code> vignette (<code class="highlighter-rouge">vignette("magrittr")</code>) in your console) provides additional examples of using pipe operators and functions provided by <code class="highlighter-rouge">magrittr</code>.</li>
  <li>A <a href="http://www.r-bloggers.com/simpler-r-coding-with-pipes-the-present-and-future-of-the-magrittr-package/">blog post</a> by Stefan Milton Bache regarding the past, present and future of <code class="highlighter-rouge">magrittr</code></li>
  <li><a href="http://stackoverflow.com/questions/tagged/magrittr"><code class="highlighter-rouge">magrittr</code> questions</a> on Stack Overflow</li>
  <li>The <a href="https://cran.r-project.org/web/packages/ensurer/vignettes/ensurer.html"><code class="highlighter-rouge">ensurer</code></a> package, also written by <a href="https://twitter.com/stefanbache">Stefan Milton Bache</a>, provides a useful way of verifying and validating data outputs in a sequence of pipe operators.</li>
</ul>

<p><small><a href="#">Go to top</a></small></p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">

      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
        <center>
          <li>
            <a href="https://github.com/bradleyboehmke">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>
            </a>
            &nbsp;
            <a href="http://www.twitter.com/bradleyboehmke">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>
            </a>
            &nbsp;
            <a href="https://www.linkedin.com/in/brad-boehmke-ph-d-9b0a257">
              <span class="icon  icon--linkedin">
                <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"  width="25" height="25" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path fill="#828282" d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51V7.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"/>
                </svg>
              </span>
            </a>
          </li>

        </ul>
        </center>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text"></p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
