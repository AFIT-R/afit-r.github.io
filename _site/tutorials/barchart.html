<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>R Programming @ UC</title>
    <meta name="description" content="">

    <link rel="stylesheet" href="http://r-uc.github.io//css/main.css">
    <link rel="canonical" href="http://r-uc.github.io/http://r-uc.github.io//tutorials/barchart">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="http://r-uc.github.io/">R Programming @ UC</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="http://r-uc.github.io//404">404 - Page not found</a>
          
        
          
          <a class="page-link" href="http://r-uc.github.io//about/">About</a>
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://r-uc.github.io//categoryview/">Archive</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://r-uc.github.io//cv/">CV</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://r-uc.github.io//tutorials/">Tutorials</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
          <a class="page-link" href="http://r-uc.github.io//tutorials/scraping_with_apis_DSCOE.Rmd">Scraping Data with APIs</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <article class="post-content">
    <p><a href="index">R Vocab Topics</a> » <a href="visualization">Visualizations</a> » Bar charts</p>

<p><br /></p>

<p>Bar charts are one of the most commonly used data visualizations. The primary purpose of a bar chart is to illustrate and compare the values for a set of <em>categorical</em> variables. To accomplish this, bar charts display the categorical variables of interest (typically) along the x-axis and the length of the bar illustrates the value along the y-axis. Consequently, the length of the bar is the primary visual cue in bar chart and this length can represent counts of cases in the data set or values for a second variable.</p>

<p><img src="/public/images/visual/barcharts/barchart_explanation.png" style="display: block; margin: auto;" /></p>

<h2 id="tldr">tl;dr</h2>
<p>This tutorial will cover how to go from a basic bar chart to a more refined, publication worthy graphic. If you’re short on time jump to the sections of interest:</p>

<ul>
  <li><a href="#replication">Replication requirements</a></li>
  <li><a href="#basics">Basic bar chart</a></li>
  <li><a href="#groups">Comparing groups</a></li>
  <li><a href="#markers">Adding value markers</a></li>
  <li><a href="#finishing">Finishing touches</a></li>
</ul>

<p><br /></p>

<h2 id="replication">Relication Requirements</h2>
<p>To reproduce the code throughout this tutorial you will need to load the following packages. The primary package of interest is <a href="http://ggplot2.org/"><code class="highlighter-rouge">ggplot2</code></a>, which is a plotting system for R. You can build bar charts with <a href="http://bradleyboehmke.github.io/tutorials/quickplots#bar">base R graphics</a>, but when I’m building more refined graphics I lean towards <code class="highlighter-rouge">ggplot2</code>.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">xlsx</span><span class="p">)</span>           <span class="c1"># for reading in Excel data
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>          <span class="c1"># for data manipulation
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span>          <span class="c1"># for data manipulation
</span><span class="n">library</span><span class="p">(</span><span class="n">magrittr</span><span class="p">)</span>       <span class="c1"># for easier syntax in one or two areas
</span><span class="n">library</span><span class="p">(</span><span class="n">gridExtra</span><span class="p">)</span>      <span class="c1"># for generating some comparison plots
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>        <span class="err">#</span> <span class="k">for</span> <span class="n">generating</span> <span class="n">the</span> <span class="n">visualizations</span></code></pre></figure>

<p>☛ <em>See <a href="http://bradleyboehmke.github.io/tutorials/basics/packages/">Working with packages</a> for more information on installing, loading, and getting help with packages.</em></p>

<p>In addition, for most of my examples I will illustrate with the built in <code class="highlighter-rouge">mtcars</code> data set.  However, for the final section I use some data that comes from Pew Research on <a href="http://www.pewsocialtrends.org/2016/05/11/americas-shrinking-middle-class-a-close-look-at-changes-within-metropolitan-areas/">America’s shrinking middle class</a>. You can obtain the data from <a href="http://www.pewsocialtrends.org/files/2016/05/Middle-Class-U.S.-Metro-Areas-5-12-16-Supplementary-Tables.xlsx">here</a>.  After importing and cleaning up the worksheet a bit the data looks as follows, which includes the distribution of adults by income tiers in 2000 and 2014 across 229 metro locations across the U.S.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># read in PEW data
</span><span class="n">income</span> <span class="o">&lt;-</span> <span class="n">read.xlsx</span><span class="p">(</span><span class="s2">"Data/PEW Middle Class Data.xlsx"</span><span class="p">,</span>
                    <span class="n">sheetIndex</span> <span class="o">=</span> <span class="s2">"1. Distribution, metro"</span><span class="p">,</span>
                    <span class="n">startRow</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">colIndex</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> <span class="m">6</span><span class="o">:</span><span class="m">8</span><span class="p">))</span> <span class="o">%&gt;%</span>
        <span class="n">set_colnames</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="s2">"Metro"</span><span class="p">,</span> <span class="s2">"Lower_00"</span><span class="p">,</span> <span class="s2">"Middle_00"</span><span class="p">,</span> <span class="s2">"Upper_00"</span><span class="p">,</span> <span class="s2">"Lower_14"</span><span class="p">,</span>
                       <span class="s2">"Middle_14"</span><span class="p">,</span> <span class="s2">"Upper_14"</span><span class="p">))</span> <span class="o">%&gt;%</span>
        <span class="n">filter</span><span class="p">(</span><span class="n">Metro</span> <span class="o">!=</span> <span class="s2">"NA"</span><span class="p">)</span>

<span class="n">head</span><span class="p">(</span><span class="n">income</span><span class="p">)</span>
<span class="c1">##                               Metro Lower_00 Middle_00 Upper_00 Lower_14 Middle_14 Upper_14
## 1                         Akron, OH    19.90     59.82    20.28    24.49     54.64    20.87
## 2       Albany-Schenectady-Troy, NY    22.09     60.07    17.84    20.15     55.08    24.78
## 3                   Albuquerque, NM    28.62     55.35    16.03    33.02     50.67    16.32
## 4 Allentown-Bethlehem-Easton, PA-NJ    23.04     60.74    16.21    25.21     55.73    19.06
## 5                      Amarillo, TX    32.25     54.72    13.04    27.42     52.56    20.02
</span><span class="err">##</span> <span class="m">6</span>                     <span class="n">Anchorage</span><span class="p">,</span> <span class="n">AK</span>    <span class="m">21.97</span>     <span class="m">58.22</span>    <span class="m">19.81</span>    <span class="m">20.25</span>     <span class="m">55.52</span>    <span class="m">24.23</span></code></pre></figure>

<p><br /></p>

<h2 id="basics">Basic Bar Chart</h2>
<p>As mentioned in the introduction bar charts are used to represent either the counts of cases of each category <em>or</em> the values of a second variable for each category.  For instance, the <code class="highlighter-rouge">mtcars</code> data set comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">head</span><span class="p">(</span><span class="n">mtcars</span><span class="p">)</span>
<span class="c1">##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
</span><span class="err">##</span> <span class="n">Valiant</span>           <span class="m">18.1</span>   <span class="m">6</span>  <span class="m">225</span> <span class="m">105</span> <span class="m">2.76</span> <span class="m">3.460</span> <span class="m">20.22</span>  <span class="m">1</span>  <span class="m">0</span>    <span class="m">3</span>    <span class="m">1</span></code></pre></figure>

<p>If we wanted to get the count of vehicles that have 4, 6 and 8 cylinders we can simply identify the x-axis variable and apply <code class="highlighter-rouge">geom_bar()</code>. This, by default will plot the count of 4, 6, and 8 cylinder vehicles in the data set. However, note that if the variable is numeric it may be interpreted as a continous variable. This is the case in Fig. A which is why the x-axis is continous in nature. We can force the cylinder variable to a categorical (factor) variable by applying <code class="highlighter-rouge">x = factor(cyl)</code> as in Fig. B, which produces a discrete x-axis.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">gridExtra</span><span class="p">)</span>

<span class="c1"># x-axis as continuous
</span><span class="n">p1</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">cyl</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Fig. A: x-axis as a continuous variable"</span><span class="p">)</span>

<span class="c1"># x-axis as categorical
</span><span class="n">p2</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Fig B: x-axis as a categorical (factor) variable"</span><span class="p">)</span>

<span class="n">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span></code></pre></figure>

<p><img src="/public/images/visual/barcharts/unnamed-chunk-5-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" /></p>

<p>An alternative use of a bar chart is to plot a second variable on the y-axis to compare the x-axis categories across.  For instance, we may want to assess the average mpg that 4, 6, and 8 cylinder cars get. To do this, we first calculate the average mpg for each cylinder and then incorprate mpg as the y-axis variable. We also need to include the argument <code class="highlighter-rouge">stat = "identity"</code> in <code class="highlighter-rouge">geom_bar()</code> which tells R to use the y values for the height of the bars.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>

<span class="n">cyl_mpg</span> <span class="o">&lt;-</span> <span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">group_by</span><span class="p">(</span><span class="n">cyl</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">summarise</span><span class="p">(</span><span class="n">avg_mpg</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">mpg</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">))</span>

<span class="n">ggplot</span><span class="p">(</span><span class="n">cyl_mpg</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">avg_mpg</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span></code></pre></figure>

<p>☛ <em>See <a href="http://bradleyboehmke.github.io//tutorials/data_wrangling">Tidy &amp; transform your data</a> for more information on data transformation with the dplyr package.</em></p>

<center>
<img src="/public/images/visual/barcharts/unnamed-chunk-6-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" />
</center>

<p>Although the default width of the bars is aesthetically pleasing, you do have the ability to adjust this attribute by setting the <code class="highlighter-rouge">width</code> in <code class="highlighter-rouge">geom_bar()</code>.  The default width is 0.9; smaller values make the bars narrower and larger values (max width of 1) make the bars wider.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">p1</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="m">.5</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"bar width = 0.5"</span><span class="p">)</span>
        

<span class="n">p2</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="m">.75</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"bar width = 0.75"</span><span class="p">)</span>

<span class="n">p3</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="m">.9</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"bar width = 0.9"</span><span class="p">)</span>

<span class="n">p4</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="m">.99</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"bar width = 0.99"</span><span class="p">)</span>

<span class="n">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">4</span><span class="p">)</span></code></pre></figure>

<p><img src="/public/images/visual/barcharts/unnamed-chunk-7-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" /></p>

<p>We can also adjust the fill and outline colors of the bars along with the opacity by applying <code class="highlighter-rouge">fill</code>, <code class="highlighter-rouge">color</code>, and <code class="highlighter-rouge">alpha</code> arguments respectively in the <code class="highlighter-rouge">geom_bar()</code> function.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s2">"dodgerblue"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"grey40"</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="m">.5</span><span class="p">)</span></code></pre></figure>

<center>
<img src="/public/images/visual/barcharts/unnamed-chunk-8-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" />
</center>

<p>There are also times when we want to plot many categories along the x-axis and the length of the names make it difficult to read. One approach to resolving this issue is to use <code class="highlighter-rouge">axis.text.x</code> argument within the <code class="highlighter-rouge">theme()</code> function to rotate the text.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">p1</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">row.names</span><span class="p">(</span><span class="n">mtcars</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Fig. A: Default x-axis"</span><span class="p">)</span>

<span class="n">p2</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">row.names</span><span class="p">(</span><span class="n">mtcars</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="n">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">90</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">vjust</span> <span class="o">=</span> <span class="m">.5</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Fig. B: Rotated x-axis"</span><span class="p">)</span>

<span class="n">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span></code></pre></figure>

<center>
<img src="/public/images/visual/barcharts/unnamed-chunk-9-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" />
</center>

<p>However, if you’re like me then you probably hate to read rotated x-axis labels.  In cases like these I think rotated bar charts are far more appealing. We can rotate the the axes by applying the <code class="highlighter-rouge">coord_flip()</code> function, which flips the x and y coordinates. To make this even easier to digest we can order the vehicles based on their mpg values as illustrated in Fig B. To do this just reorder the x variable by applying the <code class="highlighter-rouge">reorder()</code> function.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># rotate to make more readable
</span><span class="n">p1</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">row.names</span><span class="p">(</span><span class="n">mtcars</span><span class="p">),</span> <span class="n">mpg</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">coord_flip</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Fig. A: Default rotated x-axis"</span><span class="p">)</span>

<span class="c1"># order bars
</span><span class="n">p2</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">reorder</span><span class="p">(</span><span class="n">row.names</span><span class="p">(</span><span class="n">mtcars</span><span class="p">),</span> <span class="n">mpg</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">coord_flip</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Fig. B: Rotated ordered x-axis"</span><span class="p">)</span>

<span class="n">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span></code></pre></figure>

<p><img src="/public/images/visual/barcharts/unnamed-chunk-10-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" /></p>

<p><a href="#top">Go to top</a></p>

<p><br /></p>

<h2 id="groups">Comparing Groups</h2>
<p>Sometimes we want to compare different groups across the categorical variables of interest. This is primarily done via color, side-by-side bars, or stacked bars. To add a color dimension we simply add a <code class="highlighter-rouge">fill</code> argument to our first line of code to tell R what variable we want to use to color our bars. In this example we compare mpg across all the vehicles but also color the vehicles based on number of cylinders. R will use default color codings but you can set the colors manually using <code class="highlighter-rouge">scale_fill_manual</code> as in Fig. B; you can also use <code class="highlighter-rouge">scale_fill_hue</code> to change the hue across vehicles, <code class="highlighter-rouge">scale_fill_brewer</code> to color with preset color schemes (see more about ColorBrewer at <a href="http://colorbrewer2.org">http://colorbrewer2.org</a>), etc. There are many coloring options and if you type scale_fill into your RStudio help search field you will see all the possibilities.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># compare mpg across all cars and color based on cyl
</span><span class="n">p1</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">reorder</span><span class="p">(</span><span class="n">row.names</span><span class="p">(</span><span class="n">mtcars</span><span class="p">),</span> <span class="n">mpg</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">coord_flip</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">theme_minimal</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Fig. A: Default fill colors"</span><span class="p">)</span>

<span class="n">p2</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">reorder</span><span class="p">(</span><span class="n">row.names</span><span class="p">(</span><span class="n">mtcars</span><span class="p">),</span> <span class="n">mpg</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"#e5f5e0"</span><span class="p">,</span> <span class="s2">"#a1d99b"</span><span class="p">,</span> <span class="s2">"#31a354"</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">coord_flip</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">theme_minimal</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Fig. B: Manually set fill colors"</span><span class="p">)</span>

<span class="n">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span></code></pre></figure>

<p><img src="/public/images/visual/barcharts/unnamed-chunk-11-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" /></p>

<p>We can also use side-by-side bars to make comparisons. Say we want to compare the average mpg for cars across the different 4, 6, and 8 cylinder categories but also assess the impact that transmission (variable <code class="highlighter-rouge">am</code> where 0 = automatic, 1 = manual) has.  In this case we want to first summarize our data by calculating mean mpg by cylinder and transmission and then we apply the <code class="highlighter-rouge">fill</code> argument to color bars based on transmission type then include the <code class="highlighter-rouge">position = "dodge"</code> in the <code class="highlighter-rouge">geom_bar()</code> function. This tells R to have two bars for each cylinder type, color fill each bar based on the type of transmission and then adjust (aka “dodge”) the position of the bars so that they are side-by-side.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="n">avg_mpg</span> <span class="o">&lt;-</span> <span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">group_by</span><span class="p">(</span><span class="n">cyl</span><span class="p">,</span> <span class="n">am</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">summarise</span><span class="p">(</span><span class="n">mpg</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">mpg</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">))</span>

<span class="n">avg_mpg</span>
<span class="c1">## Source: local data frame [6 x 3]
## Groups: cyl [?]
## 
##     cyl    am      mpg
##   (dbl) (dbl)    (dbl)
## 1     4     0 22.90000
## 2     4     1 28.07500
## 3     6     0 19.12500
## 4     6     1 20.56667
## 5     8     0 15.05000
## 6     8     1 15.40000
</span>
<span class="n">p1</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">avg_mpg</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s2">"dodge"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Default color comparison"</span><span class="p">)</span>

<span class="c1"># more pleasing colors
</span><span class="n">p2</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">avg_mpg</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s2">"dodge"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"grey40"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">scale_fill_brewer</span><span class="p">(</span><span class="n">palette</span> <span class="o">=</span> <span class="s2">"Pastel1"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Adjusted color comparison"</span><span class="p">)</span>

<span class="n">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span></code></pre></figure>

<p>☛ <em>See <a href="http://bradleyboehmke.github.io/tutorials/data_wrangling">Tidy &amp; transform your data</a> for more information on data transformation with the dplyr package.</em></p>

<p><img src="/public/images/visual/barcharts/unnamed-chunk-12-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" /></p>

<p>You can adjust the dodge width by incorporating the <code class="highlighter-rouge">position = position_dodge(width = x)</code> argument in the <code class="highlighter-rouge">geom_bar()</code> function. By default, the width is .90 and a lower value will create overlap of your side-by-side bars and a larger value will create spacing between the bars.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">p1</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">avg_mpg</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s2">"dodge"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Default dodge positioning"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s2">"none"</span><span class="p">)</span>

<span class="n">p2</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">avg_mpg</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="n">position_dodge</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="m">.5</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Overlap of side-by-side bars"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s2">"none"</span><span class="p">)</span>

<span class="n">p3</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">avg_mpg</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="n">position_dodge</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="m">1</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Spacing between side-by-side bars"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">labs</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s2">"AM"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> <span class="n">legend.justification</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span>
              <span class="n">legend.background</span> <span class="o">=</span> <span class="n">element_blank</span><span class="p">())</span>

<span class="n">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">3</span><span class="p">)</span></code></pre></figure>

<p><img src="/public/images/visual/barcharts/unnamed-chunk-13-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" /></p>

<p>Stacked bars are the third common approach to compare groups with bar charts. By default, when you introduce a variable to color fill with in the first line, if you enter no other arguments ggplot will produce a stacked bar chart.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">avg_mpg</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span></code></pre></figure>

<center>
<img src="/public/images/visual/barcharts/unnamed-chunk-14-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" />
</center>

<p>Unfortunately, the way ggplot color codes the bars is opposite to how the colors are displayed in the legend. We can resolve this two different ways; either reverse the legend with the arguments displayed in the <code class="highlighter-rouge">guides()</code> function in Fig A. or <a href="http://bradleyboehmke.github.io/tutorials/factors#order">specify the direction of the levels</a> when transforming the transmission (<code class="highlighter-rouge">am</code>) variable into a factor as displayed in the first line of code in Fig B. Both will align the legend color coding layout to the color coding of the stacked bars but each option also helps determine which color is top versus on the bottom.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Reverse legend color coding layout
</span><span class="n">p1</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">avg_mpg</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">guides</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="n">guide_legend</span><span class="p">(</span><span class="n">reverse</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">labs</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s2">"am"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Fig A: Reverse legend"</span><span class="p">)</span>

<span class="c1"># or reverse stacking order by changing the factor levels
</span><span class="n">p2</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">avg_mpg</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">))))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">labs</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s2">"am"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Fig B: Specify levels"</span><span class="p">)</span>

<span class="n">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span></code></pre></figure>

<p><img src="/public/images/visual/barcharts/unnamed-chunk-15-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" /></p>

<p>And as before we can change the color of our stacked bars by incorporating one of the many <code class="highlighter-rouge">scale_fill_xxxx</code> arguments. Here I manually specify the colors to apply with <code class="highlighter-rouge">scale_fill_manual()</code>.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">avg_mpg</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">))))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"grey40"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"#a1d99b"</span><span class="p">,</span> <span class="s2">"#31a354"</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">labs</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s2">"AM"</span><span class="p">)</span></code></pre></figure>

<center>
<img src="/public/images/visual/barcharts/unnamed-chunk-16-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" />
</center>

<p>A common version of the stacked bar chart that you will see is the proportional stacked bar chart. In the proportional stacked bar chart each x-axis category will have stacked bars that combine to equal 100%. This allows you to see what percentage of that x-axis category is determined by an additional variable. For example, what if we want to understand what percentage of cars with 4, 6, and 8 cylinders are manual versus automatic transmission? In this case, we first tally the number of vehicles in each cylinder and transmission category and then calculate the percentages of the total cars in each cylinder category. We then use this information to create a stacked bar chart.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># calculate percentages of each cyl &amp; am category
</span><span class="n">proportion</span> <span class="o">&lt;-</span> <span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">group_by</span><span class="p">(</span><span class="n">cyl</span><span class="p">,</span> <span class="n">am</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">tally</span><span class="p">()</span> <span class="o">%&gt;%</span>
        <span class="n">group_by</span><span class="p">(</span><span class="n">cyl</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">mutate</span><span class="p">(</span><span class="n">pct</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">sum</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

<span class="n">proportion</span>
<span class="c1">## Source: local data frame [6 x 4]
## Groups: cyl [3]
## 
##     cyl    am     n       pct
##   (dbl) (dbl) (int)     (dbl)
## 1     4     0     3 0.2727273
## 2     4     1     8 0.7272727
## 3     6     0     4 0.5714286
## 4     6     1     3 0.4285714
## 5     8     0    12 0.8571429
## 6     8     1     2 0.1428571
</span>
<span class="c1"># create proportional stacked bars
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">proportion</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">pct</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">))))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"grey40"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"#a1d99b"</span><span class="p">,</span> <span class="s2">"#31a354"</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">labs</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s2">"AM"</span><span class="p">)</span></code></pre></figure>

<p>☛ <em>See <a href="http://bradleyboehmke.github.io/tutorials/data_wrangling">Tidy &amp; transform your data</a> for more information on data transformation with the dplyr package.</em></p>

<center>
<img src="/public/images/visual/barcharts/unnamed-chunk-17-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" />
</center>

<p><a href="#top">Go to top</a></p>

<p><br /></p>

<h2 id="markers">Add Value Markers</h2>
<p>Often, it is helpful to provide labels/markers on the bar charts to help the reader interpret the results correctly or just to make it easier to read the graphic. For instance, we can add the actual mpg value to the following vertical bar chart by incorporating the <code class="highlighter-rouge">geom_text()</code> function and telling the function to label each bar with the mpg value. I can also tell ggplot to nudge the values left or right sit within or outside the bar and also color the text.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">p1</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">reorder</span><span class="p">(</span><span class="n">row.names</span><span class="p">(</span><span class="n">mtcars</span><span class="p">),</span> <span class="n">mpg</span><span class="p">),</span> <span class="n">mpg</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">coord_flip</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">),</span> <span class="n">nudge_y</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>

<span class="n">p2</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">mtcars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">reorder</span><span class="p">(</span><span class="n">row.names</span><span class="p">(</span><span class="n">mtcars</span><span class="p">),</span> <span class="n">mpg</span><span class="p">),</span> <span class="n">mpg</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">coord_flip</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">),</span> <span class="n">nudge_y</span> <span class="o">=</span> <span class="m">-2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"white"</span><span class="p">)</span>

<span class="n">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span></code></pre></figure>

<p><img src="/public/images/visual/barcharts/unnamed-chunk-18-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" /></p>

<p>If you want to draw attention to one specific bar you can create a new <code class="highlighter-rouge">TRUE/FALSE</code> variable that marks the specific vehicle of interest. In the following case I also add the Make of the car as a variable since the mtcars only uses the make as a row name, which can be erased when making changes to the data frame.  You can then fill by the new ID variable in the first line of code and use <code class="highlighter-rouge">annotate()</code> to specify the exact text you want to highlight for that bar.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">cars</span> <span class="o">&lt;-</span> <span class="n">mtcars</span> <span class="o">%&gt;%</span>
        <span class="n">mutate</span><span class="p">(</span><span class="n">Make</span> <span class="o">=</span> <span class="n">row.names</span><span class="p">(</span><span class="n">mtcars</span><span class="p">),</span>
               <span class="n">ID</span> <span class="o">=</span> <span class="n">ifelse</span><span class="p">(</span><span class="n">Make</span> <span class="o">==</span> <span class="s2">"Fiat X1-9"</span><span class="p">,</span> <span class="n">TRUE</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">))</span>

<span class="n">ggplot</span><span class="p">(</span><span class="n">cars</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">reorder</span><span class="p">(</span><span class="n">Make</span><span class="p">,</span> <span class="n">mpg</span><span class="p">),</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">ID</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">coord_flip</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"grey90"</span><span class="p">,</span> <span class="s2">"dodgerblue"</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">annotate</span><span class="p">(</span><span class="s2">"text"</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">"Fiat X1-9"</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="m">22</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">"mpg = 27.3"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"white"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">theme_minimal</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s2">"none"</span><span class="p">)</span></code></pre></figure>

<p>☛ <em>See <a href="http://bradleyboehmke.github.io/tutorials/data_wrangling">Tidy &amp; transform your data</a> for more information on data transformation with the dplyr package.</em></p>

<center>
<img src="/public/images/visual/barcharts/unnamed-chunk-19-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" />
</center>

<p>Labelling grouped bars is similar, however, we need to add a <code class="highlighter-rouge">position = position_dodge(0.9)</code> argument to the <code class="highlighter-rouge">geom_text()</code> function to tell ggplot to adjust the text location. By default, the values will be centered on the top of the bar (Fig. A) but you can adjust the text to the top of the bar by including a <code class="highlighter-rouge">vjust = .5</code> argument or adjust the text to within the bar with <code class="highlighter-rouge">vjust = 1.5</code> (Fig. B).</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">p1</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">avg_mpg</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s2">"dodge"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">round</span><span class="p">(</span><span class="n">mpg</span><span class="p">,</span> <span class="m">1</span><span class="p">)),</span> <span class="n">position</span> <span class="o">=</span> <span class="n">position_dodge</span><span class="p">(</span><span class="m">0.9</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Fig A: Default text alignment"</span><span class="p">)</span>

<span class="n">p2</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">avg_mpg</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s2">"dodge"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">round</span><span class="p">(</span><span class="n">mpg</span><span class="p">,</span> <span class="m">1</span><span class="p">)),</span> <span class="n">position</span> <span class="o">=</span> <span class="n">position_dodge</span><span class="p">(</span><span class="m">0.9</span><span class="p">),</span>
                  <span class="n">vjust</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"white"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Fig B: Adjusted text alignment"</span><span class="p">)</span>

<span class="n">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span></code></pre></figure>

<p><img src="/public/images/visual/barcharts/unnamed-chunk-20-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" /></p>

<p>To add labels to a proportional bar chart we need to create a new variable in or data frame to specify the location. To do this I create a <code class="highlighter-rouge">label_y</code> variable that just <code class="highlighter-rouge">cumsum</code>s the proportions for each cylinder. You can then map the label variables to these values by incorporating the <code class="highlighter-rouge">y = label_y</code> argument in <code class="highlighter-rouge">geom_text()</code> which will place the labels at the top of of each stacked proportion bar.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># create label location for each proportional bar
</span><span class="n">proportion</span> <span class="o">&lt;-</span> <span class="n">proportion</span> <span class="o">%&gt;%</span>
        <span class="n">group_by</span><span class="p">(</span><span class="n">cyl</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">mutate</span><span class="p">(</span><span class="n">label_y</span> <span class="o">=</span> <span class="n">cumsum</span><span class="p">(</span><span class="n">pct</span><span class="p">))</span>

<span class="n">ggplot</span><span class="p">(</span><span class="n">proportion</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">factor</span><span class="p">(</span><span class="n">cyl</span><span class="p">),</span> <span class="n">pct</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">am</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">))))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"grey40"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">round</span><span class="p">(</span><span class="n">pct</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">label_y</span><span class="p">),</span> <span class="n">vjust</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"white"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"#a1d99b"</span><span class="p">,</span> <span class="s2">"#31a354"</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">labs</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s2">"AM"</span><span class="p">)</span></code></pre></figure>

<p>☛ <em>See <a href="http://bradleyboehmke.github.io/tutorials/data_wrangling">Tidy &amp; transform your data</a> for more information on data transformation with the dplyr package.</em></p>

<center>
<img src="/public/images/visual/barcharts/unnamed-chunk-21-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" />
</center>

<p><a href="#top">Go to top</a></p>

<p><br /></p>

<h2 id="finishing">Finishing Touches</h2>
<p>We can bring a lot of these components together, plus add some nice finishing touches to create a publication worthy. To illustrate I’ll use the <code class="highlighter-rouge">income</code> data that we imported in the <a href="#replication">Replication Requirements section</a>; however, being that I live in Dayton, OH I am primarily interested in assessing how the distribution of adults by income tier has changed from 2000 to 2014. To assess this let’s first filter our data to focus just on the Dayton, OH metro area and then create our basic categories to compare the percent of adults across.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">dayton</span> <span class="o">&lt;-</span> <span class="n">income</span> <span class="o">%&gt;%</span>
        <span class="n">filter</span><span class="p">(</span><span class="n">Metro</span> <span class="o">==</span> <span class="s2">"Dayton, OH"</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">gather</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">-</span><span class="n">Metro</span><span class="p">)</span> <span class="o">%&gt;%</span>
        <span class="n">separate</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">into</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"class"</span><span class="p">,</span> <span class="s2">"year"</span><span class="p">))</span> <span class="o">%&gt;%</span>
        <span class="n">mutate</span><span class="p">(</span><span class="n">year</span> <span class="o">=</span> <span class="n">ifelse</span><span class="p">(</span><span class="n">year</span> <span class="o">==</span> <span class="s2">"00"</span><span class="p">,</span> <span class="m">2000</span><span class="p">,</span> <span class="m">2014</span><span class="p">),</span>
               <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">/</span><span class="m">100</span><span class="p">)</span>

<span class="n">dayton</span>
<span class="c1">##        Metro  class year  value
## 1 Dayton, OH  Lower 2000 0.2209
## 2 Dayton, OH Middle 2000 0.5802
## 3 Dayton, OH  Upper 2000 0.1989
## 4 Dayton, OH  Lower 2014 0.2693
## 5 Dayton, OH Middle 2014 0.5272
</span><span class="err">##</span> <span class="m">6</span> <span class="n">Dayton</span><span class="p">,</span> <span class="n">OH</span>  <span class="n">Upper</span> <span class="m">2014</span> <span class="m">0.2035</span></code></pre></figure>

<p>☛ <em>See <a href="http://bradleyboehmke.github.io/tutorials/data_wrangling">Tidy &amp; transform your data</a> for more information on data transformation and reshaping with the dplyr and tidyr packages.</em></p>

<p>We can now create our basic bar chart that is a side-by-side comparison.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">dayton</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">class</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">value</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">year</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s2">"dodge"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"grey40"</span><span class="p">)</span><span class="o">+</span>
        <span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"#a1d99b"</span><span class="p">,</span> <span class="s2">"#31a354"</span><span class="p">))</span>

<span class="n">plot</span></code></pre></figure>

<center>
<img src="/public/images/visual/barcharts/unnamed-chunk-23-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" />
</center>

<p>Now let’s add some labels to the plot; however, I want to create nicely formatted labels so rather than just use the <code class="highlighter-rouge">value</code> variable I’ll create a new <code class="highlighter-rouge">y_label</code> variable with a percent formatted number.  We can now add these values to our plot with <code class="highlighter-rouge">geom_text()</code>.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">dayton</span> <span class="o">&lt;-</span> <span class="n">dayton</span> <span class="o">%&gt;%</span>
        <span class="n">mutate</span><span class="p">(</span><span class="n">y_label</span> <span class="o">=</span> <span class="n">paste0</span><span class="p">(</span><span class="n">round</span><span class="p">(</span><span class="n">value</span><span class="o">*</span><span class="m">100</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="s2">"%"</span><span class="p">))</span>

<span class="n">dayton</span>
<span class="c1">##        Metro  class year  value y_label
## 1 Dayton, OH  Lower 2000 0.2209   22.1%
## 2 Dayton, OH Middle 2000 0.5802     58%
## 3 Dayton, OH  Upper 2000 0.1989   19.9%
## 4 Dayton, OH  Lower 2014 0.2693   26.9%
## 5 Dayton, OH Middle 2014 0.5272   52.7%
## 6 Dayton, OH  Upper 2014 0.2035   20.4%
</span>
<span class="n">plot</span> <span class="o">&lt;-</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">dayton</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">class</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">value</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">year</span><span class="p">)))</span> <span class="o">+</span>
        <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s2">"identity"</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s2">"dodge"</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"grey40"</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">scale_fill_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"#a1d99b"</span><span class="p">,</span> <span class="s2">"#31a354"</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="n">y_label</span><span class="p">),</span> <span class="n">position</span> <span class="o">=</span> <span class="n">position_dodge</span><span class="p">(</span><span class="m">0.9</span><span class="p">),</span>
                 <span class="n">vjust</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"white"</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="s2">"Georgia"</span><span class="p">)</span>

<span class="n">plot</span></code></pre></figure>

<center>
<img src="/public/images/visual/barcharts/unnamed-chunk-24-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" />
</center>

<p>This is looking pretty good but now let’s add some clarity to our message by making the y axis displayed in percent form via <code class="highlighter-rouge">scale_y_continuous()</code>, create better labels for our x-axis categories via <code class="highlighter-rouge">scale_x_discrete()</code>, and add a title, subtitle and caption via <code class="highlighter-rouge">labs()</code>.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span> <span class="o">&lt;-</span> <span class="n">plot</span> <span class="o">+</span>
        <span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">scales</span><span class="o">::</span><span class="n">percent</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">scale_x_discrete</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"Lower"</span> <span class="o">=</span> <span class="s2">"Lower Class"</span><span class="p">,</span>
                         <span class="s2">"Middle"</span> <span class="o">=</span> <span class="s2">"Middle Class"</span><span class="p">,</span> <span class="s2">"Upper"</span> <span class="o">=</span> <span class="s2">"Upper Class"</span><span class="p">))</span> <span class="o">+</span>
        <span class="n">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">"Distribution of Adults by Income in Dayton, OH"</span><span class="p">,</span>
             <span class="n">subtitle</span> <span class="o">=</span> <span class="s2">"The percentage of adults in the middle class eroded by 5.3% from 2000 to 2014. Although a small \nfraction of these individuals moved into the upper class (+0.5%), the majority of these middle class \nindividuals moved into the lower income class (+4.8%)."</span><span class="p">,</span>
             <span class="n">caption</span> <span class="o">=</span> <span class="s2">"Source: Pew Research Center analysis of the \n2000 decennial census and 2014 American \nCommunity Survey (IPUMS)"</span><span class="p">)</span>

<span class="n">plot</span></code></pre></figure>

<center>
<img src="/public/images/visual/barcharts/unnamed-chunk-25-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" />
</center>

<p>Lastly, let’s do some theme editing.  I usually use a minimalistic plot so I set my base theme via <code class="highlighter-rouge">theme_minimal()</code>. Next, I remove axis titles since it become self explanatory through the title and subtitle. I also remove unecessary gridlines, rotate the legend, set the font family, and then do some title, subtitle, and caption editing.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span> <span class="o">+</span>
        <span class="n">theme_minimal</span><span class="p">()</span> <span class="o">+</span>
        <span class="n">theme</span><span class="p">(</span><span class="n">axis.title</span> <span class="o">=</span> <span class="n">element_blank</span><span class="p">(),</span>
              <span class="n">panel.grid.major.x</span> <span class="o">=</span> <span class="n">element_blank</span><span class="p">(),</span>
              <span class="n">panel.grid.minor</span> <span class="o">=</span> <span class="n">element_blank</span><span class="p">(),</span>
              <span class="n">legend.position</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> <span class="n">legend.justification</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span>
              <span class="n">legend.background</span> <span class="o">=</span> <span class="n">element_blank</span><span class="p">(),</span>
              <span class="n">legend.direction</span><span class="o">=</span><span class="s2">"horizontal"</span><span class="p">,</span>
              <span class="n">legend.title</span> <span class="o">=</span> <span class="n">element_blank</span><span class="p">(),</span>
              <span class="n">text</span> <span class="o">=</span> <span class="n">element_text</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="s2">"Georgia"</span><span class="p">),</span>
              <span class="n">plot.title</span> <span class="o">=</span> <span class="n">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">margin</span> <span class="o">=</span> <span class="n">margin</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="m">10</span><span class="p">)),</span>
              <span class="n">plot.subtitle</span> <span class="o">=</span> <span class="n">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"darkslategrey"</span><span class="p">,</span> <span class="n">margin</span> <span class="o">=</span> <span class="n">margin</span><span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="m">25</span><span class="p">)),</span>
              <span class="n">plot.caption</span> <span class="o">=</span> <span class="n">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">8</span><span class="p">,</span> <span class="n">margin</span> <span class="o">=</span> <span class="n">margin</span><span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="m">10</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">"grey70"</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">0</span><span class="p">))</span>
        </code></pre></figure>

<center>
<img src="/public/images/visual/barcharts/unnamed-chunk-27-1.png" style="display: block; margin-top:20px; margin-bottom: 20px;" />
</center>

<p><a href="#top">Go to top</a></p>

<p><br /></p>

<h2 id="wrapping-up">Wrapping Up</h2>
<p>Bar charts are a common chart that can simplistically illustrate and compare your data. When refined, they can easily communicate important aspects of your data to viewers. Hopefully this sheds some light on how to get started developing and refining bar charts with <code class="highlighter-rouge">ggplot</code>.</p>

<p><a href="#top">Go to top</a></p>

<p><br /></p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">

      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
        <center>
          <li>
            <a href="https://github.com/bradleyboehmke">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>
            </a>
            &nbsp;
            <a href="http://www.twitter.com/bradleyboehmke">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>
            </a>
            &nbsp;
            <a href="https://www.linkedin.com/in/brad-boehmke-ph-d-9b0a257">
              <span class="icon  icon--linkedin">
                <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"  width="25" height="25" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path fill="#828282" d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51V7.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"/>
                </svg>
              </span>
            </a>
          </li>

        </ul>
        </center>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text"></p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
